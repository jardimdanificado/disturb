// raylib [core] example - scissor test (Disturb port)

raylib = import("lib/raylib.urb"),
rl = raylib.load(),
if (rl == null) {
  println("raylib library not found"),
  gc.collect(),
  return 0,
}

gc.rate = 100,

screenWidth = 800,
screenHeight = 450,

rl.InitWindow(screenWidth, screenHeight, "raylib [core] example - scissor test"),
rl.SetTargetFPS(60),

if (!rl.IsWindowReady()) {
  println("raylib backend not available (DISPLAY missing?)"),
  gc.collect(),
  return 0,
}

scissorArea = rl.newRectangle(rl.Rectangle, 0.0, 0.0, 300.0, 300.0),
scissorMode = 1,

while (!rl.WindowShouldClose()) {
  if (rl.IsKeyPressed(rl.KEY_S)) {
    if (scissorMode) { scissorMode = 0, }
    else { scissorMode = 1, }
  }

  scissorX = rl.GetMouseX() - 150,
  scissorY = rl.GetMouseY() - 150,
  scissorArea.view.x = scissorX,
  scissorArea.view.y = scissorY,

  rl.BeginDrawing(),
  rl.ClearBackground(rl.RAYWHITE.view),

  if (scissorMode) {
    rl.BeginScissorMode(scissorX, scissorY, 300, 300),
  }

  rl.DrawRectangle(0, 0, rl.GetScreenWidth(), rl.GetScreenHeight(), rl.RED.view),
  rl.DrawText("Move the mouse around to reveal this text!", 190, 200, 20, rl.LIGHTGRAY.view),

  if (scissorMode) {
    rl.EndScissorMode(),
  }

  rl.DrawRectangleLinesEx(scissorArea.view, 1.0, rl.BLACK.view),
  rl.DrawText("Press S to toggle scissor test", 10, 10, 20, rl.BLACK.view),

  rl.EndDrawing(),
}

rl.CloseWindow(),
gc.collect(),
return 0,
